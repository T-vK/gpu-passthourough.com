<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="T-vK">

    <title>GPU Passthrough</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.0/css/bootstrap.min.css" integrity="sha384-PDle/QlgIONtM1aqA2Qemk5gPOE7wFq8+Em+G/hmo5Iq0CCmYZLv3fVRDJ4MMwEA" crossorigin="anonymous">

    <link href="./dashboard.css" rel="stylesheet">

  </head>

  <body>
   <nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-sm-3 col-md-2 mr-0" href="#">GPU Passthrough</a>
    <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">
    <ul class="navbar-nav px-3">
      <li class="nav-item text-nowrap">
        <a class="nav-link" href="#">Sign out</a>
      </li>
    </ul>
   </nav>

  <div class="container-fluid">
    <div class="row">


      <main role="main" class="col-md-12 col-lg-12 px-4">
<!--
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
          <h1 class="h2">Dashboard</h1>
          <div class="btn-toolbar mb-2 mb-md-0">
            <div class="btn-group mr-2">
              <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
              <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
            </div>
            <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
              <span data-feather="calendar"></span>
              This week
            </button>
          </div>
        </div>

        <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>
    -->

        <h2>Notebook compatibility list</h2>
        <div class="table-responsive">
          <table id="notebook-compatibility-list" class="table table-striped table-sm">
            <thead>
              <tr>
                <th>Device</th>
                <th>CPU and GPUs</th>
                <th>dGPU passthrough</th>
                <th>iGPU passthrough</th>
                <th>eGPU passthrough</th>
                <!--<th>Checklist</th>-->
                <th>Tested by</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>

        <div class="flex-md-nowrap align-items-center">
            <div class="alert alert-success" role="alert">
                If you tested a device, please open an issue or pull request on the <a href="https://github.com/T-vK/gpu-passthourough.com" class="alert-link">Github project for this website</a>. Thank you. :)
            </div>
        </div>
        <div class="flex-md-nowrap align-items-center">
            <div class="alert alert-success" role="alert">
                Want to check if your device is compatible? Check out project <a href="https://github.com/T-vK/MobilePassThrough/" class="alert-link">MobilePassThrough</a>. It can also set up GPU passthrough for you atuomatically.
            </div>
        </div>

      </main>
    </div>
  </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.0/js/bootstrap.min.js" integrity="sha384-7aThvCh9TypR7fIc2HV4O/nFMVCBwyIUKL8XCtKE+8xgCgl/PQGuFsvShjr74PBp" crossorigin="anonymous"></script>

    <script>
        function getGpuGuestInfo(gpus,type) {
            return gpus.map(gpu => {
                if (gpu.type !== type)
                    return ''
                let gpuGuestInfo = ''
                for (const [guest,guestInfo] of Object.entries(gpu['passthrough-guests'])) {
                     gpuGuestInfo += `${guest}: ${guestInfo}<br/>`
                }
                return `<b>${gpu.name}</b>: <br/>${gpuGuestInfo}`
            }).filter(item=>item!='').join('<br/>')
        }
        function checklistToHtml(checklist) {
            let stringChecklist = ''
            for (const [key,value] of Object.entries(checklist)) {
                 stringChecklist += `${key}: ${value}<br/>`
            }
            return stringChecklist
        }
        $.getJSON("notebook-compatibility-list.json", function(devices) {
            devices.forEach((device, i) => {
                const name = device.name
                const cpu = device.cpu
                const gpus = device.gpus.filter(gpu=>gpu.type!=='eGPU').map(gpu => `${gpu.type}: ${gpu.name}`).join('<br/>')
                const dGpus = getGpuGuestInfo(device.gpus, 'dGPU')
                const iGpus = getGpuGuestInfo(device.gpus, 'iGPU')
                const eGpus = getGpuGuestInfo(device.gpus, 'eGPU')
                const checklist = checklistToHtml(device.checklist)
                const testedBy = device['tested-by'].map(tester=>`<a href="${tester.url}">${tester.name}</a`).join('<br/>')
                const notes = device.notes

                $('#notebook-compatibility-list>tbody').append(`
                    <tr>
                        <td>${name}</td>
                        <td>CPU: ${cpu}<br/>${gpus}</td>
                        <td>${dGpus}</td>
                        <td>${iGpus}</td>
                        <td>${eGpus}</td>
                        <!--<td>${checklist}</td>-->
                        <td>${testedBy}</td>
                        <td>${notes}</td>
                    </tr>
                `);
            });
        });
    </script>
  </body>
</html>
